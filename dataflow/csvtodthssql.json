{
	"name": "csvtodthssql",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "csvtosql",
						"type": "DatasetReference"
					},
					"name": "SourceCSV"
				}
			],
			"sinks": [
				{
					"name": "SinkBatches"
				},
				{
					"name": "SinkDeathCertificates"
				}
			],
			"transformations": [
				{
					"name": "distinct"
				}
			],
			"script": "source(output(\n\t\tbatchId as integer,\n\t\tstate as string,\n\t\tstateFIPS as string,\n\t\tyear as integer,\n\t\tdateReceived as date,\n\t\tdateReady as date,\n\t\ttotalRecords as integer,\n\t\ttoReview as integer,\n\t\treviewedCount as integer,\n\t\tawaitingCount as integer,\n\t\tdthsCount as integer,\n\t\tabdtCount as integer,\n\t\trejectedCount as integer,\n\t\tbatchStatus as string,\n\t\tsubmittedBy as string,\n\t\tsubmittedDate as timestamp,\n\t\tcreatedBy as string,\n\t\tcreatedDate as timestamp,\n\t\tmodifiedBy as string,\n\t\tmodifiedDate as timestamp,\n\t\trecordId as integer,\n\t\tcpscdocnum as string,\n\t\tpdf as string,\n\t\tfirstName as string,\n\t\tlastName as string,\n\t\tnewage as integer,\n\t\tgender as string,\n\t\thispanic as string,\n\t\tethnicity as string,\n\t\trace as string,\n\t\tdod as date,\n\t\tidate as date,\n\t\tbdate as date,\n\t\taddr as string,\n\t\trescsz as string,\n\t\trescnty as string,\n\t\tinjplace as string,\n\t\tinjcsz as string,\n\t\tinjcounty as string,\n\t\tdthcsz as string,\n\t\tdthcnty as string,\n\t\twork as string,\n\t\tautop as string,\n\t\tcpsc_manner as string,\n\t\tcpsc_injdesc as string,\n\t\tcpsc_cod1 as string,\n\t\tcpsc_cod2 as string,\n\t\tcpsc_cod3 as string,\n\t\tcpsc_cod4 as string,\n\t\tcpsc_othcond as string,\n\t\tproduct1 as string,\n\t\tbertprob1 as float,\n\t\tproduct2 as string,\n\t\tbertprob2 as float,\n\t\tproduct3 as string,\n\t\tbertprob3 as float,\n\t\tscope as string,\n\t\tscopebertprob as float,\n\t\tcpsc_cod as string,\n\t\tcodprob as float,\n\t\tfireInvolved as string,\n\t\tfireprob as float,\n\t\tflag as string,\n\t\treviewed as string,\n\t\treviewedBy as string,\n\t\treviewedDate as timestamp,\n\t\treviewNotes as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> SourceCSV\nSourceCSV select(mapColumn(\n\t\tbatchId,\n\t\tstate,\n\t\tstateFIPS,\n\t\tyear,\n\t\tdateReceived,\n\t\tdateReady,\n\t\ttotalRecords,\n\t\ttoReview,\n\t\treviewedCount,\n\t\tawaitingCount,\n\t\tdthsCount,\n\t\tabdtCount,\n\t\trejectedCount,\n\t\tbatchStatus,\n\t\tsubmittedBy,\n\t\tsubmittedDate,\n\t\tcreatedBy,\n\t\tcreatedDate,\n\t\tmodifiedBy,\n\t\tmodifiedDate\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: false) ~> distinct\n sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SinkBatches\n sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SinkDeathCertificates"
		}
	}
}